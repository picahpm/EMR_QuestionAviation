using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Windows.Forms;
using DBCheckup;

namespace BKvs2010.Forms
{
    public partial class QuestionnaireFrm : Form
    {
        public QuestionnaireFrm()
        {
            InitializeComponent();
        }

        InhCheckupDataContext dbc;

        bool IsSaveComplete = false;

        private string username;
        private int? _tpr_id;
        public int? tpr_id
        {
            get { return _tpr_id; }
            set
            {
                if (value != _tpr_id)
                {
                    if (value == null)
                    {
                        Clear();
                    }
                    else
                    {
                        dbc = new InhCheckupDataContext();
                        trn_patient_regi PatientRegis = dbc.trn_patient_regis.Where(x => x.tpr_id == value).FirstOrDefault();                                                      
                        
                       try
                        {
                            //dbc = new InhCheckupDataContext();
                            username = Program.CurrentUser == null ? null : Program.CurrentUser.mut_username;
                            trn_ques_patient quePatient = PatientRegis.trn_ques_patients.FirstOrDefault();
                            if (quePatient == null)
                            {
                                //pali add  for  get last questionare  27/2/2018
                                var tpt_id = dbc.trn_patient_regis.Where(x => x.tpr_id == value).Select(x => x.tpt_id).FirstOrDefault();
                                trn_patient_regi PatientRegis_ques = dbc.trn_patient_regis.Where(x => x.tpr_id != value).Where(x => x.tpt_id == tpt_id).OrderByDescending(x => x.tpr_create_date).FirstOrDefault();
                                if (PatientRegis_ques != null)
                                {
                                    trn_ques_patient quePatient_ques = PatientRegis_ques.trn_ques_patients.FirstOrDefault();

                                    if (quePatient_ques != null)
                                    {
                                        PatientRegis.trn_ques_patients.Add(quePatient_ques);
                                    }                                
                                }
                                else
                                {                                  
                                    PatientRegis.trn_ques_patients.Add(quePatient);
                                }
                                //---> end
                                quePatient = new trn_ques_patient();
                                quePatient.tqp_create_by = username;
                                quePatient.tqp_create_date = Program.GetServerDateTime();
                                quePatient.tqp_address = PatientRegis.tpr_other_address;
                                quePatient.tqp_tumbon = PatientRegis.tpr_other_tumbon;
                                quePatient.tqp_aumphur = PatientRegis.tpr_other_amphur;
                                quePatient.tqp_province = PatientRegis.tpr_other_province;
                                quePatient.tqp_zip_code = PatientRegis.tpr_other_zip_code;
                                quePatient.tqp_mobile = PatientRegis.tpr_mobile_phone;

                            }

                            
                            
                            //quePatient.PropertyChanged += OnPropertyChanged;
                            quePatient.tqp_update_by = username;
                            quePatient.tqp_update_date = Program.GetServerDateTime();

                            if (PatientRegis.trn_patient.tpt_gender == 'M')
                            {
                                panelWomen.Enabled = false;
                            }

                            bsPatientRegis.DataSource = PatientRegis;
                            quePatient.PropertyChanged += OnPropertyChanged;
                            foreach (PropertyDescriptor property in TypeDescriptor.GetProperties(quePatient))
                            {
                                OnPropertyChanged(quePatient, new PropertyChangedEventArgs(property.Name));
                            }
                            this.Enabled = true;
                        }
                        catch (Exception ex)
                        {
                            Clear();
                            Program.MessageError(this.Name, "setProp tpr_patient_regis", ex, false);
                        }
                    }
                    patientProfileHorizontalUC1.tpr_id = value;
                    _tpr_id = value;
                }
            }
        }

        public void Clear()
        {
            this.Enabled = false;
            bsPatientRegis.DataSource = new trn_patient_regi();
            patientProfileHorizontalUC1.tpr_id = null;
            _tpr_id = null;
        }

        private void QuestionnaireFrm_Load(object sender, EventArgs e)
        {
            this.Text = PrePareData.StaticDataCls.ProjectName + "- Questionnaire";
        }
        private void QuestionnaireFrm_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (IsSaveComplete == true) { DialogResult = System.Windows.Forms.DialogResult.Yes; } else { DialogResult = System.Windows.Forms.DialogResult.No; }
        }

        private void Nextab_Click(object sender, EventArgs e)
        {
            Button btnNextTab = (Button)sender;

            switch ((string)btnNextTab.Tag)
            {
                case "1":

                    tabControl1.SelectedTab = tabControl1.TabPages[1];
                    break;
                case "2":

                    tabControl1.SelectedTab = tabControl1.TabPages[2];
                    break;
                case "3":

                    tabControl1.SelectedTab = tabControl1.TabPages[3];
                    break;
                case "4":

                    tabControl1.SelectedTab = tabControl1.TabPages[4];
                    break;
                case "5":

                    tabControl1.SelectedTab = tabControl1.TabPages[5];
                    break;
            }
        }
        private void Pretab_Click(object sender, EventArgs e)
        {
            Button btnPreTab = (Button)sender;
            switch ((string)btnPreTab.Tag)
            {
                case "1":
                    tabControl1.SelectedTab = tabControl1.TabPages[0];
                    break;
                case "2":
                    tabControl1.SelectedTab = tabControl1.TabPages[1];
                    break;
                case "3":
                    tabControl1.SelectedTab = tabControl1.TabPages[2];
                    break;
                case "4":
                    tabControl1.SelectedTab = tabControl1.TabPages[3];
                    break;
                case "5":
                    tabControl1.SelectedTab = tabControl1.TabPages[4];
                    break;
            }
        }
        private void btnNextKeyDown_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                Nextab_Click(sender, e);
            }
        }
        private void btnPreKeyDown_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                Pretab_Click(sender, e);
            }
        }
        private void btnSaveDraft_Click(object sender, EventArgs e)
        {
            if (CheckDate() == false)
            {
                lblMsg.Visible = true;
                lblMsg.Text = "วันที่สิ้นสุดน้อยกว่าวันที่เริ่มต้น กรุณาแก้ไขใหม่.";
                return;
            }

            int tpr_id = 0;
            if (Program.CurrentRegis != null)
            {
                tpr_id = Program.CurrentRegis.tpr_id;
                if (Program.chkBookComplete(tpr_id))
                {
                    this.Save('D');
                    lblMsg.Text = "Save as Draft Complete";
                    lblMsg.Visible = true;
                }
            }
        }
        private void btnSave_Click(object sender, EventArgs e)
        {
            if (CheckDate() == false)
            {
                lblMsg.Visible = true;
                lblMsg.Text = "วันที่เริ่มต้นต้องน้อยกว่าวันที่สิ้นสุด กรุณาแก้ไขใหม่.";
                return;
            }

            this.Save('N');
            lblMsg.Text = "Save Complete";
            lblMsg.Visible = true;
        }
        private void btnPrintPreview_Click(object sender, EventArgs e)
        {
            if (radThai.Checked == true)
            {
                List<string> rptCode = new List<string> { "QA201" };
                int tprID = 0;

                if (Program.CurrentRegis != null) tprID = Program.CurrentRegis.tpr_id;
                Report.frmPreviewReport frm = new Report.frmPreviewReport(tprID, rptCode);
                frm.previewReport();
            }
            else if (radEng.Checked == true)
            {
                List<string> rptCode = new List<string> { "QA202" };
                int tprID = 0;

                if (Program.CurrentRegis != null) tprID = Program.CurrentRegis.tpr_id;
                Report.frmPreviewReport frm = new Report.frmPreviewReport(tprID, rptCode);
                frm.previewReport();
            }
            else
            {
                List<string> rptCode = new List<string> { "QA201" };
                int tprID = 0;

                if (Program.CurrentRegis != null) tprID = Program.CurrentRegis.tpr_id;
                Report.frmPreviewReport frm = new Report.frmPreviewReport(tprID, rptCode);
                frm.printReport();
                //ClsReport.printRptEye(1);
            }
        }
        private void btnPrint_Click(object sender, EventArgs e)
        {
            if (radThai.Checked == true)
            {
                List<string> rptCode = new List<string> { "QA201" };
                int tprID = 0;

                if (Program.CurrentRegis != null) tprID = Program.CurrentRegis.tpr_id;
                Report.frmPreviewReport frm = new Report.frmPreviewReport(tprID, rptCode);
                frm.printReport();
                //ClsReport.printRptEye(1);
            }
            else if (radEng.Checked == true)
            {
                List<string> rptCode = new List<string> { "QA202" };
                int tprID = 0;

                if (Program.CurrentRegis != null) tprID = Program.CurrentRegis.tpr_id;
                Report.frmPreviewReport frm = new Report.frmPreviewReport(tprID, rptCode);
                frm.printReport();
                //ClsReport.printRptEye(1);
            }
            else
            {
                List<string> rptCode = new List<string> { "QA201" };
                int tprID = 0;

                if (Program.CurrentRegis != null) tprID = Program.CurrentRegis.tpr_id;
                Report.frmPreviewReport frm = new Report.frmPreviewReport(tprID, rptCode);
                frm.printReport();
                //ClsReport.printRptEye(1);
            }
        }
        private void btnSendDoc_Click(object sender, EventArgs e)
        {
            try
            {
                if (Program.CurrentUser.mut_type.ToString() == "D")
                {
                    string code = "QA201";
                    if (radThai.Checked)
                    {
                        code = "QA201";
                    }
                    else if (radEng.Checked)
                    {
                        code = "QA202";
                    }
                    else
                    {
                        code = "QA201";
                    }

                    string result = new EmrClass.DocScan.SendToDocScanCls().Send(Program.CurrentRegis.tpr_id, code, Program.CurrentSite.mhs_code, Program.CurrentUser.mut_username);
                    lblMsg.Visible = true;
                    lblMsg.Text = result;

                    //if (docscan.SendtoDocscan(code, Program.CurrentRegis.tpr_id, Program.CurrentRegis.tpr_en_no, Program.getCurrentCareProvider))
                    //{
                    //    lblMsg.Visible = true;
                    //    lblMsg.Text = "Send To Docscan Completed";

                    //    return;   

                    //}
                    //else
                    //    lblMsg.Text = "Cannot send to docsan user authentication failed";
                }
                else
                    lblMsg.Text = "Cannot send to docscan";
            }
            catch (Exception ex)
            {
                lblMsg.Text = ex.Message;
            }
        }
        private void Save(char docType)
        {
            if (docType == 'N')
            {
                bsQuesPatient.OfType<trn_ques_patient>().FirstOrDefault().tqp_confirm_doctor = Program.CurrentUser.mut_username;
                bsQuesPatient.OfType<trn_ques_patient>().FirstOrDefault().tqp_confirm_date = Program.GetServerDateTime();
            }

            try
            {
                dbc.SubmitChanges();
            }
            catch (System.Data.Linq.ChangeConflictException)
            {
                foreach (System.Data.Linq.ObjectChangeConflict occ in dbc.ChangeConflicts)
                {
                    dbc.Refresh(System.Data.Linq.RefreshMode.KeepChanges, occ.Object);
                }
                dbc.SubmitChanges();
            }
        }

        private bool CheckDate()
        {
            try
            {
                DateTime ds = (DateTime)dtpMemnopauseSt.Value.Date;
                DateTime de = (DateTime)dtpMemnopauseEnd.Value.Date;

                if (ds <= de)
                {
                    return true;
                }
                return false;
            }
            catch (Exception ex)
            {
                throw new Exception("Fail Load Datetime : " + ex.Message);
            }
        }

        private void OnPropertyChanged(object sender, PropertyChangedEventArgs e)
        {
            var value = TypeDescriptor.GetProperties(sender)[e.PropertyName].GetValue(sender);
            switch (e.PropertyName)
            {
                case "tqp_his_smok":
                    if ((char?)value != 'O') TypeDescriptor.GetProperties(sender)["tqp_his_nsmok_yrs"].SetValue(sender, 0.0);
                    if ((char?)value != 'Q') TypeDescriptor.GetProperties(sender)["tqp_his_qsmok_yrs"].SetValue(sender, 0.0);
                    if ((char?)value != 'S')
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_his_smok_amt"].SetValue(sender, 0.0);
                        TypeDescriptor.GetProperties(sender)["tqp_his_smok_dur"].SetValue(sender, 0.0);
                    }
                    txtNSmoke.Enabled = (char?)value == 'O';
                    txtQuitSmok.Enabled = (char?)value == 'Q';
                    txtSmokAmount.Enabled = (char?)value == 'S';
                    txtSmokDuration.Enabled = (char?)value == 'S';
                    break;
                case "tqp_his_alcohol":
                    if ((char?)value != 'Q') TypeDescriptor.GetProperties(sender)["tqp_his_alco_yrs"].SetValue(sender, 0.0);
                    if ((char?)value != 'S') TypeDescriptor.GetProperties(sender)["tqp_his_alco_social"].SetValue(sender, null);
                    txtQuitdrink.Enabled = (char?)value == 'Q';
                    gbSocialDrink.Enabled = (char?)value == 'S';
                    break;
                case "tqp_ill_concern":
                    if ((char?)value != 'O') TypeDescriptor.GetProperties(sender)["tqp_ill_conc_oth"].SetValue(sender, null);
                    txtPersentOther.Enabled = (char?)value == 'O';
                    break;
                case "tqp_ill_psycho":
                    if ((char?)value != 'O') TypeDescriptor.GetProperties(sender)["tqp_ill_psycho_oth"].SetValue(sender, null);
                    txtPsycOther.Enabled = (char?)value == 'O';
                    break;
                case "tqp_ill_med_his":
                    if ((char?)value != 'D')
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_hyper"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_heart"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_diab"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_coro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_dysl"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_cper"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_gout"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_abdd"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_pulm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_para"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_putb"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_stro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_kidn"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_epil"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_resp"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_sist"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_alle"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_oth"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_sist"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_pept"].SetValue(sender, false);
                    }
                    grbMedicalHis.Enabled = (char?)value == 'D';
                    break;
                case "tqp_ill_med_resp":
                    if ((bool?)value != true)
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_asth"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_emph"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_med_chro"].SetValue(sender, false);
                    }
                    groupBoxRespiratorytractdisease.Enabled = (bool?)value == true;
                    break;
                case "tqp_ill_med_canc":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_ill_med_canc_oth"].SetValue(sender, null);
                    txtRemarkCancer.Enabled = (bool?)value == true;
                    break;
                case "tqp_ill_med_oth":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_ill_med_others"].SetValue(sender, null);
                    txt_med_other.Enabled = (bool?)value == true;
                    break;
                case "tqp_ill_cur_med":
                    if ((char?)value != 'H')
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_diab"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_hyper"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_demia"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_cardi"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_dysl"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_horm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_oth"].SetValue(sender, false);
                    }
                    grbCurrentMedic.Enabled = (char?)value == 'H';
                    break;
                case "tqp_ill_cmed_oth":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_ill_cmed_others"].SetValue(sender, null);
                    txt_cur_other.Enabled = (bool?)value == true;
                    break;
                case "tqp_ill_allergy":
                    if ((char?)value != 'A') TypeDescriptor.GetProperties(sender)["tqp_ill_drug_or_food"].SetValue(sender, null);
                    txtremarkdrugorfood.Enabled = (char?)value == 'A';
                    break;
                case "tqp_pill_adm":
                    if ((char?)value != 'Y') TypeDescriptor.GetProperties(sender)["tqp_pill_admission"].SetValue(sender, null);
                    txtadmis.Enabled = (char?)value == 'Y';
                    break;
                case "tqp_pill_sur":
                    if ((char?)value != 'Y') TypeDescriptor.GetProperties(sender)["tqp_pill_surgery"].SetValue(sender, null);
                    txtsurgary.Enabled = (char?)value == 'Y';
                    break;
                case "tqp_fhis_f_disease":
                    if ((char?)value != 'D')
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_hyper"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_heart"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_diab"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_coro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_dysl"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_gout"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_pulm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_para"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_putb"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_stro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_pepu"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_asth"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_alle"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_canc"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_oth"].SetValue(sender, false);
                    }
                    grbFDisease.Enabled = (char?)value == 'D';
                    break;
                case "tqp_fhis_fdis_coro":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_coro_cs"].SetValue(sender, null);
                    pnl_fdis_coro.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_fdis_canc":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_canc_rmk"].SetValue(sender, null);
                    txt_f_canc.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_fdis_oth":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_fdis_others"].SetValue(sender, null);
                    txt_f_other.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_m_disease":
                    if ((char?)value != 'D')
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_hyper"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_heart"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_diab"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_coro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_dysl"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_gout"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_pulm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_para"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_putb"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_stro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_pepu"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_asth"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_alle"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_canc"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_oth"].SetValue(sender, false);
                    }
                    grbMDisease.Enabled = (char?)value == 'D';
                    break;
                case "tqp_fhis_mdis_coro":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_coro_cs"].SetValue(sender, null);
                    pnl_mdis_coro.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_mdis_canc":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_canc_rmk"].SetValue(sender, null);
                    txt_m_canc.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_mdis_oth":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_mdis_others"].SetValue(sender, null);
                    txt_m_other.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_b_disease":
                    if ((char?)value != 'D')
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_hyper"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_heart"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_diab"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_coro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_dysl"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_gout"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_pulm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_para"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_putb"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_stro"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_pepu"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_asth"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_alle"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_canc"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_oth"].SetValue(sender, false);
                    }
                    grbBDisease.Enabled = (char?)value == 'D';
                    break;
                case "tqp_fhis_bdis_coro":
                    if ((bool?)value != true)
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_coro_bfm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_coro_afm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_coro_nfm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_coro_bm"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_coro_am"].SetValue(sender, false);
                        TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_coro_nm"].SetValue(sender, false);
                    }
                    pnlBCHD.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_bdis_canc":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_canc_rmk"].SetValue(sender, null);
                    txt_b_canc.Enabled = (bool?)value == true;
                    break;
                case "tqp_fhis_bdis_oth":
                    if ((bool?)value != true) TypeDescriptor.GetProperties(sender)["tqp_fhis_bdis_others"].SetValue(sender, null);
                    txt_b_other.Enabled = (bool?)value == true;
                    break;
                case "tqp_fwm_menopause":
                    if ((bool?)value == true)
                    {
                        TypeDescriptor.GetProperties(sender)["tqp_fwm_meno_start"].SetValue(sender, null);
                        TypeDescriptor.GetProperties(sender)["tqp_fwm_character"].SetValue(sender, null);
                        TypeDescriptor.GetProperties(sender)["tqp_fwm_pregnancy"].SetValue(sender, null);
                        TypeDescriptor.GetProperties(sender)["tqp_fwm_over_weight"].SetValue(sender, null);
                        pnlMenopause.Enabled = false;
                        pnlCharacteristic.Enabled = false;
                        pnlPregnancy.Enabled = false;
                        pnlweightover.Enabled = false;
                    }
                    else
                    {
                        pnlMenopause.Enabled = true;
                        pnlCharacteristic.Enabled = true;
                        pnlPregnancy.Enabled = true;
                        pnlweightover.Enabled = true;
                    }
                    break;
                case "tqp_fwm_meno_start":
                    dtpMemnopauseSt.Enabled = (char?)value == 'Y';
                    dtpMemnopauseEnd.Enabled = (char?)value == 'Y';
                    break;
            }
        }
    }
}

